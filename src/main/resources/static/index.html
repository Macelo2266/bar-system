<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bar - Gestão de Estoque</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>body{font-family:Inter, sans-serif;background:#f8fafc}.fade-in{animation:fadeIn .4s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
  const { useState, useEffect, useMemo } = React;

  // Ajuste aqui se seu backend estiver em outro host/porta
  const API_BASE = "http://localhost:8080/api";

  const Icone = ({ nome, tamanho=20, classe="" }) => {
    useEffect(()=>{ lucide.createIcons(); }, [nome]);
    return <i data-lucide={nome} width={tamanho} height={tamanho} className={classe}></i>;
  };

  // AuthScreen: usa API (registrar / login)
  const AuthScreen = ({ onLogin }) => {
    const [isLogin,setIsLogin] = useState(true);
    const [formData,setFormData] = useState({ nome:'', email:'', senha:'' });
    const [erro,setErro] = useState('');

    const handleSubmit = async (e) => {
      e.preventDefault();
      setErro('');
      try {
        if(isLogin){
          const res = await fetch(`${API_BASE}/usuarios/login`, {
            method: 'POST',
            headers: { 'Content-Type':'application/json' },
            body: JSON.stringify({ email: formData.email, senha: formData.senha })
          });
          if(res.ok){
            const usuario = await res.json();
            onLogin(usuario);
          } else {
            setErro('E-mail ou senha incorretos.');
          }
        } else {
          const res = await fetch(`${API_BASE}/usuarios/registrar`, {
            method: 'POST',
            headers: { 'Content-Type':'application/json' },
            body: JSON.stringify({ nome: formData.nome, email: formData.email, senha: formData.senha })
          });
          if(res.ok){
            const usuario = await res.json();
            onLogin(usuario);
          } else {
            setErro('Não foi possível cadastrar (e-mail pode já existir).');
          }
        }
      } catch(err){
        console.error(err);
        setErro('Erro de conexão com o servidor.');
      }
    };

    return (
            <div className="min-h-screen flex items-center justify-center bg-slate-900 px-4">
              <div className="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md fade-in">
                <div className="text-center mb-8">
                  <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100 mb-4 text-indigo-600">
                    <Icone nome="wine" tamanho={32} />
                  </div>
                  <h2 className="text-2xl font-bold text-gray-800">Bar</h2>
                  <p className="text-gray-500 text-sm mt-2">{isLogin ? 'Bem-vindo de volta!' : 'Crie sua conta para começar'}</p>
                </div>

                {erro && <div className="mb-4 p-3 bg-red-100 text-red-700 text-sm rounded-lg text-center">{erro}</div>}

                <form onSubmit={handleSubmit} className="space-y-4">
                  {!isLogin && (
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Nome</label>
                            <input type="text" value={formData.nome} onChange={e=>setFormData({...formData,nome:e.target.value})} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" required placeholder="Seu nome" />
                          </div>
                  )}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" value={formData.email} onChange={e=>setFormData({...formData,email:e.target.value})} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" required placeholder="seu@email.com" />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Senha</label>
                    <input type="password" value={formData.senha} onChange={e=>setFormData({...formData,senha:e.target.value})} className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" required placeholder="******" />
                  </div>

                  <button type="submit" className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition-all transform hover:scale-[1.02]">
                    {isLogin ? 'Entrar' : 'Cadastrar'}
                  </button>
                </form>

                <div className="mt-6 text-center text-sm">
                  <span className="text-gray-500">{isLogin ? 'Não tem uma conta?' : 'Já tem uma conta?'}</span>
                  <button onClick={()=>{ setIsLogin(!isLogin); setErro(''); }} className="ml-2 text-indigo-600 font-bold hover:underline">
                    {isLogin ? 'Cadastre-se' : 'Fazer Login'}
                  </button>
                </div>
              </div>
            </div>
    );
  };

  // MainSystem: consome API de bebidas
  const MainSystem = ({ usuario, onLogout }) => {
    const [bebidas, setBebidas] = useState([]);
    const [tela,setTela] = useState('dashboard');
    const [filtro,setFiltro] = useState('');
    const [form,setForm] = useState({ id:null, nome:'', categoria:'Cerveja', preco:'', quantidade:'', imagem:'' });
    const [loading,setLoading] = useState(false);

    // Estados para relatórios
    const [relatorioDia, setRelatorioDia] = useState([]);
    const [faturamento, setFaturamento] = useState(0);

    const carregar = async () => {
      try {
        setLoading(true);
        const res = await fetch(`${API_BASE}/bebidas?usuarioId=${usuario.id}`);
        if(res.ok){
          const data = await res.json();
          setBebidas(data);
        } else {
          setBebidas([]);
        }
      } catch(e){
        console.error(e);
        setBebidas([]);
      } finally { setLoading(false); }
    };

    const carregarRelatorios = async () => {
      try {
        setLoading(true);
        const r1 = await fetch(`${API_BASE}/vendas/relatorio-dia?usuarioId=${usuario.id}`);
        if (r1.ok) {
          const relatorio = await r1.json();
          setRelatorioDia(relatorio);
        }

        const r2 = await fetch(`${API_BASE}/vendas/faturamento?usuarioId=${usuario.id}`);
        if (r2.ok) {
          const fat = await r2.json();
          setFaturamento(fat);
        }
      } catch (e) {
        console.error(e);
      } finally {
        setLoading(false);
      }
    };

    useEffect(()=>{ carregar(); }, []);

    // Atualiza relatórios quando a tela muda para 'relatorios'
    useEffect(() => {
      if (tela === 'relatorios') {
        carregarRelatorios();
      }
    }, [tela]);

    useEffect(()=>{ lucide.createIcons(); }, [tela, bebidas, relatorioDia]);

    const stats = useMemo(()=>({
      total: bebidas.length,
      qtdTotal: bebidas.reduce((acc,b)=>acc + Number(b.quantidade),0),
      baixoEstoque: bebidas.filter(b=>b.quantidade < 10).length,
      valorTotal: bebidas.reduce((acc,b)=> acc + (b.preco * b.quantidade), 0)
    }), [bebidas]);

    // Função de Venda
    const realizarVenda = async (id) => {
      const qtd = Number(prompt("Quantas unidades foram vendidas?"));

      if (!qtd || qtd <= 0) return;

      try {
        const res = await fetch(
                `${API_BASE}/bebidas/${id}/vender?quantidadeVendida=${qtd}&usuarioId=${usuario.id}`,
                { method: "PATCH" }
        );

        if (res.ok) {
          await carregar();
          alert("Venda registrada com sucesso!");
        } else {
          alert("Erro ao registrar venda.");
        }
      } catch (e) {
        alert("Erro de conexão.");
      }
    };

    // salvarBebida -> POST (novo) ou PUT (editar)
    const salvarBebida = async (e) => {
      e.preventDefault();
      try {
        const payload = {
          nome: form.nome,
          categoria: form.categoria,
          preco: parseFloat(form.preco),
          quantidade: parseInt(form.quantidade),
          imagem: form.imagem || 'https://via.placeholder.com/150'
        };

        if (form.id) {
          // editar
          const res = await fetch(`${API_BASE}/bebidas/${form.id}?usuarioId=${usuario.id}`, {
            method: 'PUT',
            headers: { 'Content-Type':'application/json' },
            body: JSON.stringify(payload)
          });
          if(res.ok) {
            await carregar();
            setTela('estoque');
          } else {
            alert('Erro ao atualizar bebida');
          }
        } else {
          // criar
          const res = await fetch(`${API_BASE}/bebidas?usuarioId=${usuario.id}`, {
            method: 'POST',
            headers: { 'Content-Type':'application/json' },
            body: JSON.stringify(payload)
          });
          if(res.ok){
            await carregar();
            setTela('estoque');
          } else {
            alert('Erro ao criar bebida');
          }
        }

        setForm({ id:null, nome:'', categoria:'Cerveja', preco:'', quantidade:'', imagem:'' });
      } catch(err){
        console.error(err);
        alert('Erro de conexão');
      }
    };

    const excluirBebida = async (id) => {
      if(!confirm('Deseja realmente excluir?')) return;
      try {
        const res = await fetch(`${API_BASE}/bebidas/${id}`, { method: 'DELETE' });
        if(res.ok || res.status === 204){
          await carregar();
        } else {
          alert('Erro ao excluir');
        }
      } catch(e){
        console.error(e);
        alert('Erro de conexão');
      }
    };

    const prepararEdicao = (b) => {
      setForm({ id:b.id, nome:b.nome, categoria:b.categoria, preco:b.preco, quantidade:b.quantidade, imagem:b.imagem });
      setTela('formulario');
    };

    const ajustarEstoque = async (id, qtd) => {
      try {
        const res = await fetch(`${API_BASE}/bebidas/${id}/estoque?quantidade=${qtd}`, { method: 'PATCH' });
        if(res.ok){
          await carregar();
        } else {
          alert('Erro ao ajustar estoque');
        }
      } catch(e){
        console.error(e);
        alert('Erro de conexão');
      }
    };

    const listaFiltrada = bebidas.filter(b =>
            b.nome.toLowerCase().includes(filtro.toLowerCase()) ||
            b.categoria.toLowerCase().includes(filtro.toLowerCase())
    );

    return (
            <div className="flex h-screen overflow-hidden bg-slate-50">
              <aside className="w-64 bg-slate-900 text-slate-300 hidden md:flex flex-col shadow-xl z-20">
                <div className="h-16 flex items-center px-6 border-b border-slate-800 font-bold text-white text-lg tracking-wide bg-slate-950">
                  <Icone nome="wine" classe="mr-2 text-indigo-500" /> Bar
                </div>
                <nav className="flex-1 p-4 space-y-2">
                  <button onClick={()=>setTela('dashboard')} className={`w-full flex items-center px-4 py-3 rounded-lg transition-colors ${tela==='dashboard'?'bg-indigo-600 text-white shadow-lg':'hover:bg-slate-800'}`}>
                    <Icone nome="layout-dashboard" classe="mr-3" /> Dashboard
                  </button>
                  <button onClick={()=>setTela('estoque')} className={`w-full flex items-center px-4 py-3 rounded-lg transition-colors ${tela==='estoque'?'bg-indigo-600 text-white shadow-lg':'hover:bg-slate-800'}`}>
                    <Icone nome="package" classe="mr-3" /> Estoque
                  </button>
                  <button onClick={() => setTela('relatorios')} className={`w-full flex items-center px-4 py-3 rounded-lg transition-colors ${tela==='relatorios' ? 'bg-indigo-600 text-white shadow-lg' : 'hover:bg-slate-800'}`}>
                    <Icone nome="bar-chart-3" classe="mr-3" /> Relatórios
                  </button>
                </nav>
                <div className="p-4 border-t border-slate-800">
                  <button onClick={onLogout} className="w-full flex items-center justify-center px-4 py-2 bg-slate-800 hover:bg-red-600 text-slate-300 hover:text-white rounded-lg transition-colors">
                    <Icone nome="log-out" classe="mr-2" /> Sair
                  </button>
                </div>
              </aside>

              <main className="flex-1 flex flex-col h-screen overflow-hidden relative">
                <header className="hidden md:flex h-16 bg-white border-b border-slate-200 items-center justify-between px-8 z-10">
                  <h2 className="text-xl font-bold text-slate-800 capitalize">{tela==='dashboard'?'Visão Geral':tela==='estoque'?'Gestão de Estoque':tela==='relatorios'?'Relatórios Financeiros':'Formulário'}</h2>
                  <div className="flex items-center gap-4">
                    <div className="flex items-center gap-3">
                      <div className="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold uppercase">{usuario.nome.charAt(0)}</div>
                      <div className="text-sm">
                        <p className="font-medium text-slate-700">{usuario.nome}</p>
                        <p className="text-xs text-slate-500">{usuario.email}</p>
                      </div>
                    </div>
                    <div className="h-8 w-px bg-slate-200 mx-2"></div>
                    <button onClick={onLogout} className="text-sm font-medium text-red-500 hover:text-red-700 flex items-center"><Icone nome="log-out" tamanho={16} classe="mr-1.5" /> Sair</button>
                  </div>
                </header>

                <header className="md:hidden h-16 bg-white border-b flex items-center justify-between px-4 z-10">
                  <span className="font-bold text-slate-800 flex items-center"><Icone nome="wine" classe="mr-2 text-indigo-600" /> Bar</span>
                  <button onClick={onLogout} className="p-2 text-red-500 bg-red-50 rounded-lg"><Icone nome="log-out" /></button>
                </header>

                <div className="flex-1 overflow-auto p-4 md:p-8 bg-slate-50/50">
                  {tela==='dashboard' && (
                          <div className="max-w-7xl mx-auto fade-in">
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                              {[
                                { titulo: 'Total Produtos', valor: stats.total, icone: 'database', cor: 'blue' },
                                { titulo: 'Em Estoque', valor: stats.qtdTotal, icone: 'layers', cor: 'indigo' },
                                { titulo: 'Estoque Baixo', valor: stats.baixoEstoque, icone: 'alert-triangle', cor: 'red' },
                                { titulo: 'Valor Estimado', valor: `R$ ${stats.valorTotal.toFixed(2)}`, icone: 'dollar-sign', cor: 'emerald' },
                              ].map((card,i)=>(
                                      <div key={i} className="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                                        <div className={`w-12 h-12 rounded-lg bg-${card.cor}-100 flex items-center justify-center text-${card.cor}-600 mb-4`}><Icone nome={card.icone} /></div>
                                        <p className="text-sm text-slate-500 font-medium">{card.titulo}</p>
                                        <p className="text-2xl font-bold text-slate-800">{card.valor}</p>
                                      </div>
                              ))}
                            </div>

                            <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                              <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                <h3 className="font-semibold text-slate-700 flex items-center gap-2"><Icone nome="alert-circle" tamanho={18} classe="text-red-500" /> Produtos Acabando (menos de 10un)</h3>
                                <button onClick={()=>setTela('estoque')} className="text-sm text-indigo-600 font-medium hover:underline">Gerenciar</button>
                              </div>
                              <div className="divide-y divide-slate-100">
                                {bebidas.filter(b => b.quantidade < 10).length === 0 ?
                                        <div className="p-8 text-center text-slate-500">Tudo certo! Nenhum alerta.</div> :
                                        bebidas.filter(b => b.quantidade < 10).map(b=>(
                                                <div key={b.id} className="px-6 py-4 flex items-center justify-between hover:bg-slate-50">
                                                  <div className="flex items-center gap-4">
                                                    <div className="w-10 h-10 rounded bg-slate-100 border overflow-hidden"><img src={b.imagem} className="w-full h-full object-cover" /></div>
                                                    <div><p className="font-medium text-slate-800">{b.nome}</p><p className="text-xs text-slate-500">{b.categoria}</p></div>
                                                  </div>
                                                  <span className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-bold">{b.quantidade} un</span>
                                                </div>
                                        ))
                                }
                              </div>
                            </div>
                          </div>
                  )}

                  {tela==='estoque' && (
                          <div className="max-w-7xl mx-auto fade-in">
                            <div className="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                              <div className="relative w-full md:w-96">
                                <Icone nome="search" classe="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" tamanho={20} />
                                <input type="text" placeholder="Buscar..." className="w-full pl-10 pr-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" value={filtro} onChange={e=>setFiltro(e.target.value)} />
                              </div>
                              <button onClick={()=>{ setForm({ id:null, nome:'', categoria:'Cerveja', preco:'', quantidade:'', imagem:'' }); setTela('formulario'); }} className="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg font-medium flex items-center justify-center shadow-md transition">
                                <Icone nome="plus-circle" classe="mr-2" /> Novo Produto
                              </button>
                            </div>

                            <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                              <div className="overflow-x-auto">
                                <table className="w-full text-left border-collapse">
                                  <thead>
                                  <tr className="bg-slate-50 text-slate-600 text-xs uppercase tracking-wider border-b">
                                    <th className="px-6 py-4 font-bold">Produto</th>
                                    <th className="px-6 py-4 font-bold">Categoria</th>
                                    <th className="px-6 py-4 font-bold">Preço</th>
                                    <th className="px-6 py-4 font-bold">Estoque</th>
                                    <th className="px-6 py-4 font-bold text-right">Ações</th>
                                  </tr>
                                  </thead>
                                  <tbody className="divide-y divide-slate-100">
                                  {listaFiltrada.map(b=>(
                                          <tr key={b.id} className="hover:bg-slate-50 transition-colors">
                                            <td className="px-6 py-4">
                                              <div className="flex items-center gap-3">
                                                <img src={b.imagem} className="w-10 h-10 rounded object-cover bg-slate-100" onError={e=>e.target.src='https://via.placeholder.com/40'} />
                                                <span className="font-medium text-slate-700">{b.nome}</span>
                                              </div>
                                            </td>
                                            <td className="px-6 py-4"><span className="px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600">{b.categoria}</span></td>
                                            <td className="px-6 py-4 text-slate-600">R$ {Number(b.preco).toFixed(2)}</td>
                                            <td className="px-6 py-4">
                                              <div className="flex items-center gap-2">
                                                <button onClick={()=>ajustarEstoque(b.id, -1)} className="w-7 h-7 rounded border hover:bg-red-50 text-slate-500 flex items-center justify-center"><Icone nome="minus" tamanho={14} /></button>
                                                <span className={`w-8 text-center font-bold ${b.quantidade < 10 ? 'text-red-500' : 'text-slate-700'}`}>{b.quantidade}</span>
                                                <button onClick={()=>ajustarEstoque(b.id, 1)} className="w-7 h-7 rounded border hover:bg-green-50 text-slate-500 flex items-center justify-center"><Icone nome="plus" tamanho={14} /></button>
                                              </div>
                                            </td>
                                            <td className="px-6 py-4 text-right flex justify-end gap-2">
                                              <button onClick={() => realizarVenda(b.id)}
                                                      className="p-2 text-green-600 hover:bg-green-50 rounded-lg">
                                                <Icone nome="shopping-cart" tamanho={18} />
                                              </button>

                                              <button onClick={() => prepararEdicao(b)}
                                                      className="p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg">
                                                <Icone nome="edit-3" tamanho={18} />
                                              </button>

                                              <button onClick={() => excluirBebida(b.id)}
                                                      className="p-2 text-red-500 hover:bg-red-50 rounded-lg">
                                                <Icone nome="trash-2" tamanho={18} />
                                              </button>
                                            </td>
                                          </tr>
                                  ))}

                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                  )}

                  {tela==='formulario' && (
                          <div className="max-w-2xl mx-auto fade-in">
                            <button onClick={()=>setTela('estoque')} className="mb-6 flex items-center text-slate-500 hover:text-slate-800 transition font-medium"><Icone nome="arrow-left" classe="mr-2" /> Voltar</button>

                            <div className="bg-white p-8 rounded-xl shadow-sm border border-slate-200">
                              <h2 className="text-2xl font-bold text-slate-800 mb-6">{form.id ? 'Editar' : 'Novo Produto'}</h2>
                              <form onSubmit={salvarBebida} className="space-y-6">
                                <div>
                                  <label className="block text-sm font-semibold text-slate-700 mb-2">Nome</label>
                                  <input required type="text" value={form.nome} onChange={e=>setForm({...form, nome:e.target.value})} className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" />
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                  <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">Categoria</label>
                                    <select value={form.categoria} onChange={e=>setForm({...form, categoria:e.target.value})} className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500">
                                      <option>Cerveja</option><option>Vinho</option><option>Destilado</option><option>Outros</option>
                                    </select>
                                  </div>
                                  <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">Preço</label>
                                    <input required type="number" step="0.01" value={form.preco} onChange={e=>setForm({...form, preco:e.target.value})} className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500" />
                                  </div>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                  <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">Estoque</label>
                                    <input required type="number" value={form.quantidade} onChange={e=>setForm({...form, quantidade:e.target.value})} className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500" />
                                  </div>
                                  <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-2">Imagem (URL)</label>
                                    <input type="text" value={form.imagem} onChange={e=>setForm({...form, imagem:e.target.value})} className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500" />
                                  </div>
                                </div>

                                <div className="flex justify-end gap-3 pt-4">
                                  <button type="button" onClick={()=>setTela('estoque')} className="px-6 py-2 border rounded-lg hover:bg-slate-50">Cancelar</button>
                                  <button type="submit" className="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-bold">Salvar</button>
                                </div>
                              </form>
                            </div>
                          </div>
                  )}

                  {tela === 'relatorios' && (
                          <div className="max-w-4xl mx-auto fade-in">
                            <h2 className="text-3xl font-bold mb-6 text-slate-800">Relatórios</h2>

                            <div className="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                              <h3 className="text-xl font-semibold mb-4 text-slate-700">Faturamento do Dia</h3>
                              <p className="text-3xl font-bold text-green-600">
                                R$ {faturamento.toFixed(2)}
                              </p>
                            </div>

                            <div className="mt-8 bg-white p-6 rounded-xl shadow-md border border-slate-200">
                              <h3 className="text-xl font-semibold mb-4 text-slate-700">Vendas Realizadas Hoje</h3>

                              {relatorioDia.length === 0 && (
                                      <p className="text-slate-500 italic">Nenhuma venda hoje.</p>
                              )}

                              {relatorioDia.length > 0 && (
                                      <ul className="divide-y divide-slate-100">
                                        {relatorioDia.map(v => (
                                                <li key={v.id} className="py-4 flex justify-between items-center hover:bg-slate-50 px-2 rounded transition">
                                                  <div>
                                                    <span className="font-medium text-slate-800">{v.bebida ? v.bebida.nome : 'Produto excluído'}</span>
                                                    <span className="text-sm text-slate-500 ml-2">({v.quantidadeVendida} un)</span>
                                                  </div>
                                                  <span className="font-bold text-slate-700">R$ {v.valorTotal.toFixed(2)}</span>
                                                </li>
                                        ))}
                                      </ul>
                              )}
                            </div>
                          </div>
                  )}
                </div>

              </main>
            </div>
    );
  };

  // App root
  const App = () => {
    const [usuario, setUsuario] = useState(() => {
      const s = localStorage.getItem('bar_usuario_sessao');
      return s ? JSON.parse(s) : null;
    });

    useEffect(()=>{
      if(usuario) localStorage.setItem('bar_usuario_sessao', JSON.stringify(usuario));
      else localStorage.removeItem('bar_usuario_sessao');
    }, [usuario]);

    return usuario ? <MainSystem usuario={usuario} onLogout={()=>setUsuario(null)} /> : <AuthScreen onLogin={setUsuario} />;
  };

  const root = ReactDOM.createRoot(document.getElementById('root'));
  root.render(<App />);
</script>
</body>
</html>

